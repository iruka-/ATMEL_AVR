<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja">

<head>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <title>2014-08 - PukiWiki</title>

<!---
 <link rel="stylesheet" media="screen and (max-width:768px)" href="../skin/180wiki-sp.css" />

 --->

 <link rel="stylesheet" media="screen and (max-width:768px)" href="../skin/monobook/mobile.css" />
 <link rel="stylesheet" media="screen and (min-width:769px)" href="../skin/monobook/monobook.css" />

 <link rel="stylesheet" type="text/css" media="print" href="../skin/monobook/monobook.print.css" />
 <link rel="alternate" type="application/rss+xml" title="RSS" href="./?cmd=rss" />

 <meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>
<body>
<div id="globalWrapper">
 <div id="menubar">
<ul class="list1 list-indent1"><li><a href="/ATMEL_AVR/html/" title="FrontPage" class="link_page_passage">Ｔｏｐ</a></li></ul>
<hr class="full_hr" />
<p><a href="EF-BC-A8-EF-BC-A9-EF-BC-A4-EF-BD-81-EF-BD-93-EF-BD-90-EF-BD-98-.html" class="link_page_passage">ＨＩＤａｓｐｘ</a></p>
<ul class="list1 list-indent1"><li><a href="EF-BC-A4-EF-BD-8F-EF-BD-97-EF-BD-8E-EF-BC-AC-EF-BD-8F-EF-BD-81-EF-BD-84-.html" class="link_page_passage">ＤｏｗｎＬｏａｄ</a></li>
<li><a href="EF-BC-A8-EF-BC-A9-EF-BC-A4-EF-BD-81-EF-BD-93-EF-BD-90-E9-AB-98-E9-80-9F-E5-8C-96-.html" class="link_page_passage">ＨＩＤａｓｐ高速化</a></li>
<li><strong><a href="Newest.html" title="Newest" class="link_page_passage">開発日記</a></strong> <a href="SiteMap.html" title="SiteMap" class="link_page_passage">ログ</a></li></ul>
<p><a href="E5-88-B6-E4-BD-9C-.html" class="link_page_passage">制作</a></p>
<p><a href="AVRetc.html" title="AVRetc" class="link_page_passage">ＡＶＲ関係</a></p>
<ul class="list1 list-indent1"><li><a href="AVR_Monit.html" class="link_page_passage">AVR_Monit</a></li>
<li><a href="AVR_term.html" class="link_page_passage">AVR_term</a></li>
<li><a href="W32_term.html" class="link_page_passage">W32_term</a></li>
<li><a href="HIDmon88.html" class="link_page_passage">HIDmon88</a></li>
<li><a href="HIDtester.html" class="link_page_passage">HIDtester</a></li>
<li><a href="usbRS232.html" class="link_page_passage">usbRS232</a></li>
<li><a href="Arduino2313.html" class="link_page_passage">Arduino2313</a></li>
<li><a href="E3-83-87-E3-82-B8-E3-82-BF-E3-83-AB-E3-83-86-E3-82-B9-E3-82-BF-E3-83-BC-.html" class="link_page_passage">デジタルテスター</a></li>
<li><a href="ATmega88E7-94-9F-E6-B4-BB-.html" class="link_page_passage">ATmega88生活</a></li>
<li><a href="KeyBoardE3-83-9E-E3-83-8B-E3-82-A2-.html" class="link_page_passage">KeyBoardマニア</a></li>
<li><a href="KeyBoardE3-83-9E-E3-83-8B-E3-82-A2-II.html" class="link_page_passage">KeyBoardマニアII</a></li>
<li><a href="Arduino400.html" class="link_page_passage">Arduino400</a></li>
<li><a href="PICspx.html" title="PICspx" class="link_page_passage">PICライター</a></li>
<li><a href="hid_blaster.html" title="hid_blaster" class="link_page_passage">ARMライター</a></li>
<li><a href="E8-B5-A4-E5-A4-96-E7-B7-9A-E3-83-AA-E3-83-A2-E3-82-B3-E3-83-B3-.html" class="link_page_passage">赤外線リモコン</a></li></ul>
<p><a href="ARM.html" class="link_page_passage">ARM</a></p>
<ul class="list1 list-indent1"><li><a href="armon.html" title="armon" class="link_page_passage">STM32ブートローダー</a></li>
<li><a href="stm32f103.html" title="stm32f103" class="link_page_passage">STM8S-Discovery改造</a></li>
<li><a href="stm8s_blaster.html" title="stm8s_blaster" class="link_page_passage">STM8S-OpenOCDライター</a></li>
<li><a href="LPCXpresso.html" class="link_page_passage">LPCXpresso</a></li>
<li><a href="lpc2D-armon.html" title="lpc-armon" class="link_page_passage">LPC用ブートローダー</a></li>
<li><a href="LPCUSB.html" title="LPCUSB" class="link_page_passage">NXP用LPCUSB</a></li>
<li><a href="ARM7mon.html" title="ARM7mon" class="link_page_passage">NXP用ブートローダー</a></li>
<li><a href="LPC1114.html" title="LPC1114" class="link_page_passage">MARY基板</a></li>
<li><a href="LPC1114FN28.html" class="link_page_passage">LPC1114FN28</a></li>
<li><a href="arm_blaster.html" title="arm_blaster" class="link_page_passage">OpenOCD　JTAGアダプター</a></li>
<li><a href="openocd2D-build.html" title="openocd-build" class="link_page_passage">OpenOCDビルド方法</a></li>
<li><a href="arm2D-gcc.html" title="arm-gcc" class="link_page_passage">arm-gccビルド方法</a></li>
<li><a href="mapleIDE.html" title="mapleIDE" class="link_page_passage">mapleIDEの改造</a></li>
<li><a href="libmapleE3-81-A7-E4-BB-AE-E6-83-B3-COM.html" class="link_page_passage">libmapleで仮想COM</a></li></ul>
<p>PIC32</p>
<ul class="list1 list-indent1"><li><a href="PIC32MX.html" class="link_page_passage">PIC32MX</a></li>
<li><a href="Pinguino.html" title="Pinguino" class="link_page_passage">Pinguinoで遊ぼう</a></li>
<li><a href="HIDBootX.html" title="HIDBootX" class="link_page_passage">ブートローダーを作る</a></li>
<li><a href="uartflash32.html" title="uartflash32" class="link_page_passage">シリアルブートローダー</a></li>
<li><a href="PIC32MX_USBCDC.html" title="PIC32MX_USBCDC" class="link_page_passage">USB仮想シリアル</a></li>
<li><a href="USB_CUSTOM.html" title="USB_CUSTOM" class="link_page_passage">USBカスタムデバイス</a></li>
<li><a href="PIC32mon.html" title="PIC32mon" class="link_page_passage">USB簡易モニター</a></li>
<li><a href="USBE3-82-AA-E3-82-B7-E3-83-AD-E3-82-B9-E3-82-B3-E3-83-BC-E3-83-97-.html" class="link_page_passage">USBオシロスコープ</a></li>
<li><a href="USB_HOST.html" title="USB_HOST" class="link_page_passage">USBホスト</a>　</li>
<li><a href="Bluetooth.html" title="Bluetooth" class="link_page_passage">PIC32でBluetooth</a>　</li>
<li><a href="USBAudio.html" class="link_page_passage">USBAudio</a>　</li>
<li><a href="USBStudy.html" class="link_page_passage">USBStudy</a>　</li>
<li><a href="pic32vga.html" title="pic32vga" class="link_page_passage">VGA出力に挑戦</a></li>
<li><a href="tinyBasic2.html" title="tinyBasic2" class="link_page_passage">BASICを動かす</a></li>
<li><a href="WinUSB.html" class="link_page_passage">WinUSB</a>　</li>
<li><a href="PIC32MXcust.html" title="PIC32MXcust" class="link_page_passage">勝手に改蔵*PIC32</a></li></ul>
<p>PIC18F</p>
<ul class="list1 list-indent1"><li><a href="pic18boot.html" title="pic18boot" class="link_page_passage">HIDブートローダー</a></li>
<li><a href="pic18spx.html" title="pic18spx" class="link_page_passage">AVR/PIC両用ライター</a></li>
<li><a href="pic18blaster.html" title="pic18blaster" class="link_page_passage">ARMライター</a></li>
<li><a href="pic18monit.html" title="pic18monit" class="link_page_passage">usb汎用クラス</a></li>
<li><a href="usbserial.html" title="usbserial" class="link_page_passage">usbシリアル変換</a></li>
<li><a href="pic18hidkey.html" title="pic18hidkey" class="link_page_passage">usbキーボード変換</a></li>
<li><a href="sdcc.html" title="sdcc" class="link_page_passage">sdccを使いこなす</a></li>
<li><a href="mcc18.html" title="mcc18" class="link_page_passage">mcc18を使いこなす</a></li>
<li><a href="HIDmon2D-2550.html" class="link_page_passage">HIDmon-2550</a></li>
<li><a href="HIDmon2D-14K50.html" class="link_page_passage">HIDmon-14K50</a></li>
<li><a href="PICmonitor.html" class="link_page_passage">PICmonitor</a></li></ul>
<p>試行錯誤の記録</p>
<ul class="list1 list-indent1"><li><a href="UBW.html" title="UBW" class="link_page_passage">UBWを試す</a></li>
<li><a href="HIDboot.html" title="HIDboot" class="link_page_passage">旧HIDboot</a></li>
<li><a href="PIC18F2550.html" title="PIC18F2550" class="link_page_passage">PIC18F2550試用記</a></li>
<li><a href="PIC18F4550.html" title="PIC18F4550" class="link_page_passage">PIC18F4550試用記</a></li></ul>
<p>その他マイコン</p>
<ul class="list1 list-indent1"><li><a href="NEC78K.html" class="link_page_passage">NEC78K</a></li>
<li><a href="RX62N.html" class="link_page_passage">RX62N</a></li>
<li><a href="SH2A.html" class="link_page_passage">SH2A</a></li>
<li><a href="EF-BC-A8-EF-BC-98-.html" class="link_page_passage">Ｈ８</a></li>
<li><a href="FM3.html" class="link_page_passage">FM3</a></li>
<li><a href="ubuntuXP.html" title="ubuntuXP" class="link_page_passage">XPからubuntuに乗り換え</a></li>
<li><a href="Android.html" class="link_page_passage">Android</a></li>
<li><a href="Xen2D-hypervisor.html" class="link_page_passage">Xen-hypervisor</a></li>
<li><a href="Windows8E3-82-AB-E3-82-B9-E3-82-BF-E3-83-9E-E3-82-A4-E3-82-BA-.html" class="link_page_passage">Windows8カスタマイズ</a></li></ul>
<p>開発日記</p>
<ul class="list1 list-indent1"><li><a href="20152D-04.html" class="link_page_passage">2015-04</a></li></ul>
<hr class="full_hr" />
<p>ノウハウ</p>
<ul class="list1 list-indent1"><li><a href="AVRUSB_Tips.html" class="link_page_passage">AVRUSB_Tips</a></li>
<li><a href="EF-BC-A8-EF-BC-A9-EF-BC-A4-EF-BD-81-EF-BD-93-EF-BD-90-E6-83-85-E5-A0-B1-.html" class="link_page_passage">ＨＩＤａｓｐ情報</a></li>
<li><a href="E6-B1-8E-E7-94-A8-EF-BC-B5-EF-BC-B3-EF-BC-A2-2D-EF-BC-A9-EF-BC-AF-.html" class="link_page_passage">汎用ＵＳＢ-ＩＯ</a></li></ul>
<hr class="full_hr" />
<p>・<a href="AVRlink.html" title="AVRlink" class="link_page_passage">リンク</a></p>
<p>フリースペース</p>
<ul class="list1 list-indent1"><li><a href="/ATMEL_AVR/cgi-bin/note/index.cgi" rel="nofollow">ゲストブック</a></li></ul>
<hr class="full_hr" />
<p><a href="EF-BC-B7-EF-BD-89-EF-BD-84-EF-BD-85-EF-BC-B4-EF-BD-85-EF-BD-98-EF-BD-94-.html" title="ＷｉｄｅＴｅｘｔ" class="link_page_passage">旧コンテンツ</a><br />
<a href="EF-BC-B7-EF-BD-89-EF-BD-8E-EF-BC-B6-EF-BD-89-EF-BD-93-EF-BD-94-EF-BD-81-.html" class="link_page_passage">ＷｉｎＶｉｓｔａ</a><br />
<a href="E3-82-A4-E3-83-B3-E3-82-BF-E3-83-BC-E3-83-95-E3-82-A7-E3-83-BC-E3-82-B9-E8-80-83-.html" class="link_page_passage">インターフェース考</a></p>
<hr class="full_hr" />
<h5>最新の20件</h5>
<div><strong>2024-10-18</strong>
<ul class="recent_list">
 <li><a href="20222D-08.html" class="link_page_passage">2022-08</a></li>
</ul>
<strong>2024-10-11</strong>
<ul class="recent_list">
 <li><a href="Poem/SCMP2.html" class="link_page_passage">Poem/SCMP2</a></li>
 <li><a href="Poem/Ollama.html" class="link_page_passage">Poem/Ollama</a></li>
 <li><a href="Newest.html" class="link_page_passage">Newest</a></li>
</ul>
<strong>2024-10-10</strong>
<ul class="recent_list">
 <li><a href="Poem/GitList.html" class="link_page_passage">Poem/GitList</a></li>
 <li><a href="Poem/Win11upg.html" class="link_page_passage">Poem/Win11upg</a></li>
 <li><a href="Poem/LXCUbuntu.html" class="link_page_passage">Poem/LXCUbuntu</a></li>
 <li><a href="Poem/JavaScriptBBS.html" class="link_page_passage">Poem/JavaScriptBBS</a></li>
 <li><a href="Poem/SourceCodeViewer.html" class="link_page_passage">Poem/SourceCodeViewer</a></li>
 <li><a href="Poem/mkCert.html" class="link_page_passage">Poem/mkCert</a></li>
 <li><a href="Poem/WebPush.html" class="link_page_passage">Poem/WebPush</a></li>
</ul>
<strong>2024-07-01</strong>
<ul class="recent_list">
 <li><a href="node.jsE3-81-AE-E5-85-A5-E3-82-8C-E6-96-B9-.html" class="link_page_passage">node.jsの入れ方</a></li>
</ul>
<strong>2024-06-29</strong>
<ul class="recent_list">
 <li><a href="20242D-07.html" class="link_page_passage">2024-07</a></li>
</ul>
<strong>2024-06-21</strong>
<ul class="recent_list">
 <li><a href="SMRE3-81-AA-HDDE3-83-99-E3-83-B3-E3-83-81-E3-83-9E-E3-83-BC-E3-82-AF-.html" class="link_page_passage">SMRなHDDベンチマーク</a></li>
 <li><a href="UEFI_Basic.html" class="link_page_passage">UEFI_Basic</a></li>
</ul>
<strong>2024-06-20</strong>
<ul class="recent_list">
 <li><a href="MenuBar.html" class="link_page_passage">MenuBar</a></li>
</ul>
<strong>2022-12-06</strong>
<ul class="recent_list">
 <li><a href="MSE3-82-A2-E3-82-AB-E3-82-A6-E3-83-B3-E3-83-88-E3-81-AE-WindowsE3-81-AE-CE3-83-89-E3-83-A9-E3-82-A4-E3-83-96-E3-82-92-E4-BF-AE-E5-BE-A9-E3-81-99-E3-82-8B-.html" class="link_page_passage">MSアカウントのWindowsのCドライブを修復する</a></li>
</ul>
<strong>2022-09-29</strong>
<ul class="recent_list">
 <li><a href="AndroidE3-81-AB-SSLE8-87-AA-E5-B7-B1-E7-BD-B2-E5-90-8D-E8-A8-BC-E6-98-8E-E6-9B-B8-E3-82-92-E5-85-A5-E3-82-8C-E3-82-8B-.html" class="link_page_passage">AndroidにSSL自己署名証明書を入れる</a></li>
</ul>
<strong>2022-08-31</strong>
<ul class="recent_list">
 <li><a href="E7-B0-A1-E6-98-93-E9-80-9F-E5-BA-A6-E6-B8-AC-E5-AE-9A-E3-82-B5-E3-82-A4-E3-83-88-.html" class="link_page_passage">簡易速度測定サイト</a></li>
 <li><a href="E3-83-8D-E3-83-83-E3-83-88-E3-83-AF-E3-83-BC-E3-82-AF-BOOT.html" class="link_page_passage">ネットワークBOOT</a></li>
</ul>
</div>
</div>
 <div id="mainColumnWrapper">
  <div id="main-column">
   <div id="navigator"><ul><li class="selected" id="separate"><a href="">本文</a></li><li><a href="./?cmd=edit&amp;page=2014-08">編集</a></li><li><a href="./?cmd=diff&amp;page=2014-08">差分</a></li></ul></div>
   <div id="content">
    <h1 class="firstHeading">2014-08</h1><div id="contentSub"></div>
    <p><a href="20142D-04.html" class="link_page_passage">2014-04</a>
　<a href="FM3.html" class="link_page_passage">FM3</a>　<a href="RX62N.html" class="link_page_passage">RX62N</a>　<a href="SH2A.html" class="link_page_passage">SH2A</a>　<a href="PIC32MX.html" class="link_page_passage">PIC32MX</a></p>
<h2 id="content_1_0">２０１４年８月<a class="anchor_super" id="x9ba25d1" href="#x9ba25d1" title="x9ba25d1" style="user-select:none;">&dagger;</a></h2>
<p>積み案件</p>
<ul class="list1 list-indent1"><li>１）<a href="20132D-11.html" title="2013-11" class="link_page_passage">PIC32MXを使った単体BASIC(あるいはC言語)コンピューター</a>。</li>
<li>２）<a href="uartflash32.html" title="uartflash32" class="link_page_passage">シリアルポート接続用（ファームサイズ3kB以内）のPinguinoローダー</a>。</li></ul>
<p><br />
１）はモチベーションの低下。（もうすでに飽きている）</p>
<p>２）は完成済。</p>
<p>３）<del>でAndroidのADKを試そうとしていて足踏み中。（進捗どうですか：永遠に零）</del> --- <a href="USB_HOST.html" class="link_page_passage">USB_HOST</a>参照</p>
<p>４）STM32F4 DISCOVERYをDISCOVERY（ジャンク箱から発見）したった。（未使用だけど埃被ってた）。mbedで遊ぼうかどうか思案中。（夏休みの電子工作ってことで・・・爆！）</p>
<p>５）STM32F4 nucleoを買おうかどうか思案中。これもDOSCO_F407VGが終わってからか。</p>
<p>６）<strong><a href="http://www.moae.jp/comic/harurock" rel="nofollow">ハルロック</a>１巻買ったよ</strong></p>
<p>７）Kbox2 とか Linux-on-Androidとかの復讐（え゛）
<br />
<br />
<br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_1">11bitコンピュータのアセンブラとシミュレータ<a class="anchor_super" id="tf593a2a" href="#tf593a2a" title="tf593a2a" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li><a href="20132D-03.html#wcbef61d" title="2013-03" class="link_page_passage">R16エミュレータ</a>の焼き直し版。</li></ul>
<p><a href="/ATMEL_AVR/upload/R16/R11.zip" rel="nofollow">ダウンロードはこちら</a></p>
<ul class="list1 list-indent1"><li>アセンブラ、シミュレータ(Windows/Linux兼用) gccソース込み。</li>
<li>MITライセンスにしています。</li>
<li>１ワード16bit命令の似たようなコンピュータなら、ちょっと改造したら移植できるかも。</li>
<li>某トランジスタ製コンピュータのCPUによく似ています。が、互換性はないと思います。（練習用とか）
<ul class="list2 list-indent1"><li>これも、ちょっと改造したら移植できるかも。</li></ul></li></ul>
<p><br />
<br />
<br /></p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_2">11bitコンピュータで円周率を求めるには・・・<a class="anchor_super" id="yddd98ec" href="#yddd98ec" title="yddd98ec" style="user-select:none;">&dagger;</a></h2>
<pre>π＝4 * arctan(1)</pre>
<ul class="list1 list-indent1"><li>arctan()はマクローリン展開すると線形多項式になる。</li></ul>
<ul class="list1 list-indent1"><li>たぶんこんな感じの関数をASMで書くと良いような気がする。
<pre>int main()
{
   short i,pi=0,k=400;
   for(i=1;i&lt;1000;i+=2) {
      pi = pi + k / i;
      k=k*(-1);
   }
   printf(&quot;pi=%d\n&quot;,pi);
} </pre></li>
<li>だけど64ステップで書けるかと言われると<span style="font-size:5px">・・・x86なら除算もあるので出来るけど・・・</span><span style="font-size:64px">それは無理</span></li></ul>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_3">11bitコンピュータで円周率を求めてみた。<a class="anchor_super" id="e294d26a" href="#e294d26a" title="e294d26a" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li>例のブログにヒントがありました。</li>
<li>マチンの公式を使います。</li>
<li>多倍長演算は使いません。(11bit精度です)</li>
<li>割り算は引き算のループです。</li></ul>
<p><br />
<br /></p>
<ul class="list1 list-indent1"><li>さっき、{それは無理}と書いたけれど、<span style="font-size:64px">やれば出来る</span></li></ul>
<p><br /></p>
<p><br /></p>
<pre>                                      //
                                      //	RAMは後半 1k WORD の 先頭から 4 WORD存在すると仮定している.
                                      //
0000:                                 work0:     equ  0x400 
0000:                                 work1:     equ  0x401 
0000:                                 work2:     equ  0x402 
0000:                                 work3:     equ  0x403 
                                      //	work3はCALL命令のPC保存用(RET)で使用する.
                                      
0000:                                            org  0 
                                      //----------------------------------------------------------------
                                      //
                                      //		atan(x)=x-(1/3)*x^3+(1/5)*x^5-(1/7)*x^7....
                                      //
                                      //	pi=4*(4*atan(1/5) - atan(1/239))
                                      //	  =16 * (1/5) - (16*(1/5)/3 *(1/5)*(1/5)) - 4 * (1/239)
                                      //
                                      //	浮動小数-&gt;整数の下駄履きは 係数500を掛けているので、
                                      //	  =1600 - (1600/75) - (2000/239)
                                      //	結果の整数値(下駄履き係数500) を 500 で割ると、3.14になる.
                                      //----------------------------------------------------------------
                                      
0000:                                 main:            
0000:0640                                        mov  a,1600 		// 4*4*100
                                      //	mov b,5			// 係数500を掛けているので、5で割らずそのまま.
                                      //	call div_ab
                                      //	mov [work0],c	// work0=4*4*(1/5)
0001:3400                                        mov  [work0],a 	// work0=4*4*(1/5)
                                      
0002:1c00                                        mov  a,[work0] 
0003:084b                                        mov  b,75 		// 3*5*5
0004:1006 5814                                   call div_ab 
0006:3c01                                        mov  [work1],c 	// work1=4*4*(1/5) /3 *(1/5) * (1/5)
                                      
0007:1c00                                        mov  a,[work0] 
0008:2401                                        mov  b,[work1] 
0009:5000                                        sub  a,b 
000a:3400                                        mov  [work0],a 	// work0=16*atan(1/5) (マクローリン展開は２項のみ)
                                      
                                      
000b:07d0                                        mov  a,2000 		// 4*500
000c:08ef                                        mov  b,239 
000d:100f 5814                                   call div_ab 
000f:3c01                                        mov  [work1],c 	// work1=4*atan(1/239) == 4*(1/239)
                                       
0010:1c00                                        mov  a,[work0] 
0011:2401                                        mov  b,[work1] 
0012:5000                                        sub  a,b 
                                      //	答えはAレジスタに残る. 係数500が掛かった固定小数.
                                      
0013:                                 halt:            
0013:5813                                        jmp  halt 
                                      
                                      //	C=A/B
0014:                                 div_ab:          
0014:3c03                                        mov  [work3],c 
0015:17ff                                        mov  c,0x7ff 
0016:                                 div_loop:        
0016:4801                                        add  c,1 
0017:5000                                        sub  a,b 
0018:6816                                        jnc  div_loop 
0019:6403                                        ret   
                                      
001a:                                            end   
                                      
                                      </pre>
<ul class="list1 list-indent1"><li>わずか26ステップで出来ました。</li>
<li>基数変換とか桁別表示を入れると64ステップくらい食うかも。</li></ul>
<p><a href="/ATMEL_AVR/upload/R16/R11.zip" rel="nofollow">ダウンロードはこちら</a> -- アセンブラ、シミュレータも全部込みです。</p>
<p><br />
<br />
<br />
<span style="font-size:8px">このCPU、とっても小っちゃいのに、気に入りました。</span></p>
<ul class="list1 list-indent1"><li>実はSC/MP-IIに少し似ています。</li>
<li>SC/MP-IIは、acc以外では16bit長のレジスタ（ポインタ）が3本とPC(16bit長)が１本あります。</li>
<li>16bit長のレジスタ(インデックスレジスタ)の４番目がPCというお約束になっていて、PCは４番目のインデックスレジスタという設定になってます。</li>
<li>命令の種類がとても少ないというのは共通点。</li>
<li>フルアセンブラで書くしかない、というのも共通点。全然コンパイラ向きではありません。</li>
<li>スタックポインタが無いことも共通点。</li>
<li><del>遅いことも共通点</del> ＼（^ ^);;</li></ul>
<p><br />
<br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_4">Android をRoot化する<a class="anchor_super" id="w875cad5" href="#w875cad5" title="w875cad5" style="user-select:none;">&dagger;</a></h2>
<p>Kingo Android Rootというのを使うらしい。</p>
<ul class="list1 list-indent1"><li><a href="http://www.kingoapp.com/android-root.htm" rel="nofollow">http://www.kingoapp.com/android-root.htm</a></li></ul>
<p><br /></p>
<ul class="list1 list-indent1"><li>/system/以下 が書き換え出来ないときは、rwで再マウントするだけ。</li></ul>
<pre># mount -orw,remount /system</pre>
<ul class="list1 list-indent1"><li>戻すときは、
<pre># mount -oro,remount /system</pre></li></ul>
<ul class="list1 list-indent1"><li>この辺はLinuxと同じだけど、Androidはディレクトリ構成がアレですな。</li></ul>
<p><br />
結局root化はKingoのおかげで簡単にできたけど、</p>
<ul class="list1 list-indent1"><li>/system/xbin/su を消しても消しても、OS再起動すると現れる怪、と</li>
<li>ゲームアプリが起動しなくなる怪、が未解決＜---今ここ。</li></ul>
<ul class="list1 list-indent1"><li>あと、ubuntu入れようとしたけど、 /data/ がたったの2GBなのでどうしようか思案中。</li>
<li>ext_SDは16GB挿してるけど、そこにLinux入れるの？って感じか。</li></ul>
<p><br />
<br />
<br />
<br /></p>
<p>参考、このへん</p>
<ul class="list1 list-indent1"><li><a href="http://juggly.cn/archives/96693.html" rel="nofollow">http://juggly.cn/archives/96693.html</a></li>
<li><a href="http://gatolynx.blog100.fc2.com/blog-entry-150.html" rel="nofollow">http://gatolynx.blog100.fc2.com/blog-entry-150.html</a></li></ul>
<ul class="list1 list-indent1"><li><a href="http://anago.2ch.net/test/read.cgi/applism/1387372999/" rel="nofollow">http://anago.2ch.net/test/read.cgi/applism/1387372999/</a></li></ul>
<p>別に、ゲームアプリをどうこうしたいわけじゃなくて、busybox使いたいだけなのに、
それによってゲームアプリが起動しなくなるんだったら、ゲームアプリ消せばいいわけで・・・。</p>
<p>まあ、よくわからん。</p>
<p><br /></p>
<p><br />
<br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_5">PIC32MX 220F032B(220円PIC)でAndroid端末を繋いでみる。<a class="anchor_super" id="raae84b9" href="#raae84b9" title="raae84b9" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li><strong>進捗は、ありまぁーす。</strong></li></ul>
<p><a href="/ATMEL_AVR/jpg/PIC/adkdemo.png" rel="nofollow"><img src="/ATMEL_AVR/jpg/PIC/adkdemo.png" alt="/ATMEL_AVR/jpg/PIC/adkdemo.png" /></a></p>
<p>もっと読む: <a href="USB_HOST.html" class="link_page_passage">USB_HOST</a></p>
<p><br />
<br /></p>
<p><br />
<br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_6">KBox2とlibfakechrootについてのメモ =&gt; <a href="Android.html" class="link_page_passage">Android</a><a class="anchor_super" id="wf9e9629" href="#wf9e9629" title="wf9e9629" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li><a href="http://kevinboone.net/kbox2.html" rel="nofollow">KBox2</a>というのは、root権限取ってない Android端末でLinux(Unix)っぽいCUIシェルを実現させるための環境。</li></ul>
<ul class="list1 list-indent1"><li>おなじみの<a href="https://github.com/jackpal/Android-Terminal-Emulator" rel="nofollow">Jackpal：Android-Terminal-Emulator</a>からログインする。</li></ul>
<ul class="list1 list-indent1"><li>Android端末の
<pre>/data/data/jackpal.androidterm/kbox2/</pre></li>
<li>というディレクトリにインストールされる。</li></ul>
<ul class="list1 list-indent1"><li>環境変数はこんな感じ
<pre>FAKECHROOT='true'
FAKECHROOT_BASE='/data/data/jackpal.androidterm/kbox2'
FAKECHROOT_EXCLUDE_PATH='/data/data/jackpal.androidterm/kbox2:/data/data/jackpal.androidterm/kbox2'
FAKECHROOT_VERSION='2.16'
HOME='/home/kbox'
・・・
KBOX='/data/data/jackpal.androidterm/kbox2'
LD_LIBRARY_PATH='/data/data/jackpal.androidterm/kbox2/lib:/data/data/jackpal.androidterm/kbox2/usr/lib'
LD_PRELOAD='/data/data/jackpal.androidterm/kbox2/lib/libfakechroot.so'</pre></li></ul>
<p><br />
<strong>そもそも、libfakechrootって、何？</strong></p>
<ul class="list1 list-indent1"><li>root権限なしでchrootするツール。(chrootというのは、ファイルシステムの'/' マウントポイントを現在のファイルシステムの任意のディレクトリ位置に再設定する機能)</li>
<li>Debianとかで、dpkg作るときに使われるツール。</li>
<li>cygwinもこの原理で動いているらしい。</li></ul>
<p><br />
どうやって実現しているの？</p>
<ul class="list1 list-indent1"><li>ld.so の LD_PRELOAD 機能を使って、 /lib/libfakechroot.so を libc.soよりも先に常駐（リンク）させておく。</li>
<li>libc.soの open や chdir , opendir 等をhookしてディレクトリ位置を置き換える。</li></ul>
<p><br />
試し方：</p>
<ul class="list1 list-indent1"><li>１）<a href="https://github.com/jackpal/Android-Terminal-Emulator" rel="nofollow">Jackpal：Android-Terminal-Emulator</a>をインストールする。</li>
<li>２）google playでOneBoxインストーラーをインストールしてKBox2環境を手に入れる、もしくは、<a href="http://kevinboone.net/kbox2.html" rel="nofollow">KBox2</a>のダウンロードから、インストーラーをダウンロードして、Android-Terminal-Emulatorから、
<pre>$ chmod +x kbox2-base-installer 
$ ./kbox2-base-installer 
$ ./setup</pre></li>
<li>３）Android-Terminal-Emulatorの設定メニューで、初期起動するシェルスクリプトを以下のパスのスクリプトにしておくと、即座にKbox2のshに入れる。
<pre>/data/data/jackpal.androidterm/kbox2/bin/kbox_shell</pre></li></ul>
<p><br />
これで、暫く試しているのだが、Androidの問題点があって、</p>
<ol class="list1 list-indent1"><li>スクリーンキーボードがすこぶる使いにくい。</li>
<li>USB(Device)接続による携帯用の中華USB外付キーボードがまた、配置がでたらめすぎて、死ぬほど使えない。</li>
<li>Bluetooth接続のキーボードもまた、使いにくい。</li></ol>
<p><br />
どれも、３分で使用をあきらめた。
<br /></p>
<ul class="list1 list-indent1"><li>Kbox2にはsshdサーバーやtelnetdサーバーのようなものが用意されていて、ssh経由で繋ぐことが出来る・・・筈なんだけれど</li>
<li>たいていの無線LAN(WiFi)はWindows PCやLinux PCと異なるLANセグメントに閉じ込められる(ルーターモード)ので、WiFiセグメントからLANセグメントへのssh接続は可能だが、その逆(PCからAndroidへssh)はブロックされる。</li></ul>
<p><strong>結局adbで繋ぐことに・・・・</strong></p>
<ul class="list1 list-indent1"><li>AndroidSDKを入れる。（既に入れてあるなら不要)</li>
<li>USBで繋いでおいて、adb shell を立ち上げる。</li>
<li>/data/data/jackpal.androidterm/kbox2/bin/kbox_shell を起動する。 <strong>（root権限が必要）</strong></li></ul>
<p><br />
最後が、全く<span style="font-size:32px">本末転倒。</span></p>
<p><br />
<br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_7">Kbox2 の Hello Worldを書いてみる。<a class="anchor_super" id="h3e4d11c" href="#h3e4d11c" title="h3e4d11c" style="user-select:none;">&dagger;</a></h2>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_8">その１）普通にhello.c を書く.<a class="anchor_super" id="r4adee04" href="#r4adee04" title="r4adee04" style="user-select:none;">&dagger;</a></h4>
<pre>#include &lt;stdio.h&gt;
int main(int argc,char **argv)
{
    printf(&quot;Hello, World.\n&quot;);
}</pre>
<ul class="list2 list-indent2"><li>kbox2のgccでコンパイル
<pre>$ gcc hello.c -o hello</pre></li>
<li>実行
<pre>$ ./hello</pre></li></ul>
<p><br /></p>
<ul class="list1 list-indent1"><li>ここまでは、インストール猿なら、誰でも出来る。努力も根性も不要。
<br />
<br /></li></ul>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_9">その２）Ubuntu Linux(PC)を用意する。<a class="anchor_super" id="w4431c55" href="#w4431c55" title="w4431c55" style="user-select:none;">&dagger;</a></h4>
<ul class="list1 list-indent1"><li>VMWarePlayer上でも構わない。</li>
<li>何が面倒かって？それは Android NDKのインストールだよーん。 ---&gt;がんばれ俺！</li></ul>
<p><br />
延々とダウンロード</p>
<p>黙々とインストール</p>
<ul class="list1 list-indent1"><li>NDKのインストール先は、とりあえず、
<pre>NDK_PATH=&quot;/usr/local/android-ndk-r9d/&quot;</pre></li>
<li>としておいて、</li>
<li>先ほどのhello.cを用意。</li></ul>
<p>ＫμＣさんのブログを参考に、やってみる。</p>
<ul class="list1 list-indent1"><li><a href="http://blog.kmckk.com/archives/2918551.html" rel="nofollow">http://blog.kmckk.com/archives/2918551.html</a></li></ul>
<p>Makefileを書く</p>
<pre>#
#CC = $(NDK_PATH)/build/prebuilt/linux-x86/arm-eabi-4.4.0/bin/arm-eabi-gcc
CC = $(NDK_PATH)/toolchains/arm-linux-androideabi-4.8/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gcc

LIBS = -llog
TARGET_ARCH_CFLAGS = -march=armv5te -msoft-float

#SYSROOT = $(NDK_PATH)/build/platforms/android-4/arch-arm
SYSROOT = $(NDK_PATH)/platforms/android-19/arch-arm
CFLAGS  = -mandroid --sysroot=$(SYSROOT) $(TARGET_ARCH_CFLAGS)
LDFLAGS = -mandroid --sysroot=$(SYSROOT) $(LIBS)

hello : hello.o</pre>
<ul class="list1 list-indent1"><li>makeする
<pre>$ make</pre></li>
<li>できたhello (android ARM用のelf) を端末に転送する。
<ul class="list2 list-indent1"><li>とりあえず、端末のkboxシェルから、Linux側にsshプロトコルで scp出来るようだ。
<pre>$ scp linuxuser@192.168.1.xxx:hello .</pre></li></ul></li>
<li>実行する
<pre>$ ./hello</pre></li></ul>
<ul class="list1 list-indent1"><li>一応fopenとかやってみて、fakechrootされているところまで確認した。</li></ul>
<ul class="list1 list-indent1"><li>たぶん、これで、普通にCで書かれていてlibc.soだけに依存しているソースは実行ファイルが作れる、ということは分かったけど、</li>
<li>./configureとかどうするんだろう。ドキドキ</li></ul>
<p><br />
<br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_10">Kbox2 用のtarを作ってみる。<a class="anchor_super" id="v3e53b24" href="#v3e53b24" title="v3e53b24" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li>busyboxのtarは展開のみで圧縮機能が無かった。
<ul class="list2 list-indent1"><li>これはbusyboxをビルドするときにスイッチで指定出来るらしい。</li></ul></li>
<li>手始めにubuntuのtarをKbox2用にビルドしてみることにする。</li></ul>
<p>やり方は、またまた、ＫμＣさんのブログを参考にしてみた。</p>
<ul class="list2 list-indent2"><li><a href="http://blog.kmckk.com/archives/2918745.html" rel="nofollow">AndroidのNDKツールを使ってrubyをビルドして動かす</a></li></ul>
<p><br />
まず、Ubuntu14.04LTSマシンを用意する（VMWarePlayer上でも可能）</p>
<ul class="list1 list-indent1"><li>１）tarのソースを取得する。
<pre>$ mkdir build
$ cd build
$ apt-get source tar</pre></li>
<li>２）configure用のスクリプトを書いてみる
<ul class="list2 list-indent1"><li>config.sh
<pre>#!/bin/sh
# NDKのインストール先.
export NDK_PATH=&quot;/usr/local/android-ndk-r9d/&quot;

export SYSROOT=$NDK_PATH/platforms/android-19/arch-arm
export CFLAGS=&quot;-march=armv5te -msoft-float &quot;
export CC=&quot;$NDK_PATH/toolchains/arm-linux-androideabi-4.8/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gcc -mandroid --sysroot=$SYSROOT&quot;

# ./tar-1.27.1/ に tarのソースがあること.

mkdir work
cd work
../tar-1.27.1/configure --host=arm-eabi --disable-ipv6 --prefix=/system/local --enable-shared</pre></li></ul></li>
<li>３）上記 config.shを実行
<pre>$ chmod +x config.sh
$ ./config.sh</pre></li>
<li>４）Android用にクロスビルドする。
<pre>$ cd work
$ make</pre></li>
<li>５）いくつかコンパイルエラーが出る
<ul class="list2 list-indent1"><li>例えば、mkfifo.c 関数の二重定義 ---&gt; mkfifo.c の該当関数をコメントアウト</li>
<li>実行時、futimensが無い。---&gt; config.h 書き換え
<pre>/* Define to 1 if you have the `futimens' function. */
/* #define HAVE_FUTIMENS 1 */</pre></li></ul></li>
<li>６）直したら、再ビルド
<pre>$ make</pre></li>
<li>７）出来たelfを転送、実行
<pre>$ cp src/tar ~/</pre></li>
<li>Kbox2からsshでコピー、実行
<pre>$ scp linuxuser@192.168.1.xxx:tar .
$ ./tar</pre></li>
<li>８）/bin/tar を消して置き換える
<pre>$ cd /bin
$ ls -l tar
$ rm tar
$ mv /home/kbox/tar .</pre></li></ul>
<p><br />
やっと、tarのアーカイブ作成が可能になりました。</p>
<p><br />
<br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_11">Linux-on-Android<a class="anchor_super" id="c6d6b1c2" href="#c6d6b1c2" title="c6d6b1c2" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li>complete-linux-installer
<ul class="list2 list-indent1"><li><a href="https://play.google.com/store/apps/details?id=com.zpwebsites.linuxonandroid&amp;hl=ja" rel="nofollow">https://play.google.com/store/apps/details?id=com.zpwebsites.linuxonandroid&amp;hl=ja</a></li></ul></li></ul>
<ul class="list1 list-indent1"><li>入れてみた。</li>
<li>Imageはubuntu-13.04.core.v2.img.zip みたいなやつ。</li></ul>
<ul class="list1 list-indent1"><li>ubuntu14.04は、まだ用意されていない。</li></ul>
<ul class="list1 list-indent1"><li>たしか、12.04のころは、complete-installerは有料アプリだったはず。</li>
<li>img.zipをunzipするところはinstaller側でのサポートが無くて手動っぽい。（なので、imgをダウンロードしてSD-Cardに転送するところはPCでやったほうが早い)</li>
<li>/mnt/external_sd/ あたりに 1GBのimgファイルを置いておいて、complete-installerから、そのディレクトリ、ファイルを指定して、Launchする。</li></ul>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_12">KBox2 と Ubuntu-on-Androidの得失<a class="anchor_super" id="sb7ff0c2" href="#sb7ff0c2" title="sb7ff0c2" style="user-select:none;">&dagger;</a></h2>
<div class="ie5"><table class="style_table" cellspacing="1" border="0">
<tr class="style_tr"><td class="style_td"></td><td class="style_td">KBox2</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">Ubuntu-on-Android</td></tr>

<tr class="style_tr"><td class="style_td">root権限</td><td class="style_td">不要</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">必要</td></tr>

<tr class="style_tr"><td class="style_td">インストールに消費されるDisk容量</td><td class="style_td">軽量(50MB程度?)</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">重量級(1GB〜)</td></tr>

<tr class="style_tr"><td class="style_td">利点</td><td class="style_td">気軽にLinuxコマンドを実行できる</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">Ubuntu Linuxそのものを利用できる</td></tr>

<tr class="style_tr"><td class="style_td"></td><td class="style_td">root権限が要らないのでroot化の危険を回避できる</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">apt-get等を使用してパッケージ導入が簡単</td></tr>

<tr class="style_tr"><td class="style_td"></td><td class="style_td">root化端末で使うことも出来る</td><td class="style_td"></td><td class="style_td"></td><td class="style_td"></td></tr>

<tr class="style_tr"><td class="style_td"></td><td class="style_td">（ '/android_root/'以下に、ネイティブのファイルシステムが見えているので、いろいろ出来る）</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">&lt;===（loop mountなのでそれは無理）</td></tr>

<tr class="style_tr"><td class="style_td">弱点</td><td class="style_td">自分でdebパッケージを作るのが難しい</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">Ubuntuのバージョンがやや古い(13.04)ので、実はapt-getリポジトリにアクセス出来ないことが多い</td></tr>

<tr class="style_tr"><td class="style_td"></td><td class="style_td">配布されているdebパッケージが限定的で少ない、日本語対応していない</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">（/etc/apt/source.listのraringをsaucyに書き換えることで少し回避できる）</td></tr>

<tr class="style_tr"><td class="style_td"></td><td class="style_td">コアパッケージや派生パッケージのソースが公開されていない</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">'/'ファイルシステムが1GBのimgファイルなので、Android側の'/system/'とかをいじりたくても触れないもどかしさがある。（無理やりマウントは出来ないのだろうか）</td></tr>

<tr class="style_tr"><td class="style_td"></td><td class="style_td">自分でビルドするための情報が不足している</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">TCP portのアクセス権限がないので、sshとかするにはひと工夫要るらしい</td></tr>

<tr class="style_tr"><td class="style_td"></td><td class="style_td">/binとかのコマンドの大半がbusyboxなので、サブセット感が半端ない</td><td class="style_td"></td><td class="style_td"></td><td class="style_td">（昔やったことあるけど、もうやり方を忘れている）</td></tr>

<tr class="style_tr"><td class="style_td"></td><td class="style_td">（例えばtarはextract専用だったりとか）</td><td class="style_td"></td><td class="style_td"></td><td class="style_td"></td></tr>
</table></div>
<p>もっと読む: <a href="Android.html" class="link_page_passage">Android</a>
<br />
<br />
<br /></p>
<p><br />
<br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_13"><a href="Bluetooth.html" title="Bluetooth" class="link_page_passage">PIC32MX Bluetoothを試す</a><a class="anchor_super" id="uba580b2" href="#uba580b2" title="uba580b2" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li>btstack for PIC32 を試してみた。</li></ul>
<p>もっと読む: <a href="Bluetooth.html" title="Bluetooth" class="link_page_passage">PIC32MX Bluetoothを試す</a></p>
<p><br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_14"><a href="USBAudio.html" title="USBAudio" class="link_page_passage">PIC32MX USB Audio を試す</a><a class="anchor_super" id="uba580b2" href="#uba580b2" title="uba580b2" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li>USB Audio Speaker for PIC32 を試してみた。</li></ul>
<p>もっと読む: <a href="USBAudio.html" title="USBAudio" class="link_page_passage">PIC32MX USB Audio を試す</a></p>
<p><br />
<br /></p>
<p><br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_15">Dockerメモ<a class="anchor_super" id="qff79e6b" href="#qff79e6b" title="qff79e6b" style="user-select:none;">&dagger;</a></h2>
<p>Qiita</p>
<ul class="list1 list-indent1"><li><a href="http://qiita.com/voluntas/items/bb7c46fdfc709d97f9a5" rel="nofollow">http://qiita.com/voluntas/items/bb7c46fdfc709d97f9a5</a></li></ul>
<ul class="list1 list-indent1"><li>とりあえずインストール
<pre># apt-get install docker.io</pre>
<ul class="list2 list-indent1"><li>dockerだけだと Gnomeのdockerという、わけわからん物がインストールされる（47kBくらいのやつ）注意してね。</li></ul></li></ul>
<ul class="list1 list-indent1"><li>たったこんだけで走る。(bashだけ、だけどね)
<pre>$ docker run -i -t base /bin/bash</pre></li></ul>
<p><br /></p>
<ul class="list1 list-indent1"><li>まあ、lxcも簡単だったけど、Dockerはもっと簡単なのか。
<ul class="list2 list-indent1"><li>動作原理は<a href="http://shibayu36.hatenablog.com/entry/2013/12/30/173949" rel="nofollow">このへん</a>に書かれている。</li>
<li>aufsはunion filesystemで、二つのファイルシステム(roとrw)をレイヤーで重ねて見せるようなやつだと思われ。</li>
<li>で、結局LXC使ってんじゃん、というツッコミは無しで。</li></ul></li></ul>
<p><br /></p>
<ul class="list1 list-indent1"><li>コンテナのイメージ（と言うのか？）が作られる場所は
<pre>/var/lib/docker/aufs/mnt/＜わけわからんGUIDな文字列＞/
/var/lib/docker/aufs/diff/＜わけわからんGUIDな文字列＞/</pre>
と
<pre>/var/lib/docker/aufs/mnt/＜わけわからんGUIDな文字列＞-init/
/var/lib/docker/aufs/diff/＜わけわからんGUIDな文字列＞-init/</pre>
そのまんま普通にLXCのrootfsみたいな感じだけど、４つに分けられている意味が分からなかった。</li></ul>
<p><br /></p>
<ul class="list1 list-indent1"><li>たぶん、mnt/ が付いてるやつは、ほんとに union mountされている mount pointなんじゃあなかろうか（つまり、Dockerコンテナの / はそこにmountされている)　？？？要確認</li></ul>
<ul class="list2 list-indent2"><li>試したところ、mnt/のほうはゲストを終了させるとファイル消滅して空ディレクトリだけになるので、たぶんマウントポイントだけの役割なのだろう。</li>
<li>diff/のほうには、rootfsのユーザーランドがなんとなく全部残っている感じ。（GUID名は異なる）</li>
<li>で、ゲストが更新したファイル<strong>だけ</strong>が、diff/＜わけわからんGUIDな文字列＞/ 以下に残っていた。</li></ul>
<ul class="list1 list-indent1"><li>＜わけわからんGUIDな文字列＞ が、長すぎて嫌〜。
<br />
<br /></li></ul>
<p><br />
<strong>困ったちゃん。</strong></p>
<ul class="list1 list-indent1"><li>Ubuntu14.10 (Unity) で試したんだけど、Dockerの中でapt-getしようとしたら、ubuntu12.10(quantal)になってて、apt-get出来なかった。
<ul class="list2 list-indent1"><li>なんで、せめて14.04LTSを base にしてないんだろう。あほなの？</li></ul></li></ul>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_16">Dockerチートシート<a class="anchor_super" id="v6f4e59d" href="#v6f4e59d" title="v6f4e59d" style="user-select:none;">&dagger;</a></h4>
<ul class="list1 list-indent1"><li><a href="http://qiita.com/bungoume/items/b8911fd243d9c084bd63" rel="nofollow">http://qiita.com/bungoume/items/b8911fd243d9c084bd63</a></li>
<li>これいいかも。</li></ul>
<ul class="list1 list-indent1"><li>メジャーなレポジトリ</li></ul>
<p>busybox, centos, ubuntu, debian</p>
<ul class="list1 list-indent1"><li>公式イメージ。人気なのは言わずもがな</li></ul>
<p>dockerfile/*</p>
<ul class="list1 list-indent1"><li>Dockerfile Projectが管理。</li>
<li>ElasticSearch,nginx,redis,mongodbなど。baseはubuntu 14.04</li></ul>
<p>base</p>
<ul class="list1 list-indent1"><li>今は非推奨。中身はubuntu12.10。</li></ul>
<p><br />
案の定、baseのかわりにubuntuにしたら、14.04LTSになった。</p>
<p><br /></p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_17">結論<a class="anchor_super" id="l0bb4b8a" href="#l0bb4b8a" title="l0bb4b8a" style="user-select:none;">&dagger;</a></h2>
<ul class="list1 list-indent1"><li>まあ、そういうわけで、似たようなコンテナを沢山飼いたいときは、union fs使ったほうがディスク領域の節約になるし、コンテナの中のファイルをいじった場合に、何を変えたかすぐわかるし、初期状態（というか自分の都合のよい初期設定状態）にリセットしたり、同じようなコンテナを複製したりが<strong>超楽</strong>になるはずなので、<strong>Dockerお勧め</strong>かもね。</li></ul>
<p><br />
<br /></p>
<hr class="full_hr" />

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h2 id="content_1_18"><a href="USBStudy.html" title="USBStudy" class="link_page_passage">UsbStudyをPIC32MX に移植する </a><a class="anchor_super" id="w54924b7" href="#w54924b7" title="w54924b7" style="user-select:none;">&dagger;</a></h2>
<p>もっと読む: <a href="USBStudy.html" class="link_page_passage">USBStudy</a>
<br />
<br />
<br />
<a href="20142D-04.html" title="2014-04" class="link_page_passage">＜前の月</a>｜<a href="20142D-12.html" title="2014-12" class="link_page_passage">次の月＞</a></p>
   </div>
  </div>
 </div>
 <div style="clear:both;height:1em;"></div>
 <div id="logo"><a href="/ATMEL_AVR/html/" style="background-image: url(image/title.jpg);"></a></div>
 <div id="personal"><ul><li class="login"><a href="http://">ログインまたはアカウント作成</a></li></ul></div>
 <div id="footer">
  <div id="f-officialico">
   <a href="http://pukiwiki.sourceforge.jp/"><img src="../image/b_pukiwiki.official.png" alt="PukiWiki-official" /></a>
  </div>
  <div id="f-officialdevico">
   <a href="http://pukiwiki.sourceforge.jp/dev/"><img src="../image/b_pukiwiki.dev.png" alt="PukiWiki-dev" /></a>
  </div>
  <div id="f-list">
   <ul><li id="lastmod">Last-modified: 2014-11-17 (月) 14:44:26<span class="page_passage" data-mtime="2014-11-17T14:44:26+09:00"></span></li><li>Site admin: <a href="http://pukiwiki.example.com/">anonymous</a></li>    <li>Powered by PukiWiki</li>
    <li><a href="http://www.luntf.com/">Monobook for PukiWiki</a></li>
   </ul>
  </div>
  <div style="clear:both;"></div>
 </div>
</div>
</body>
</html>
